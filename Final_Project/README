Hello!

Welcome to my final project about generating strained crystal structures and their energies relative to a native unit cell observed in nature. 

Most of the contents of this README are also present within the Jupyter Notebook itself (see file directory below), but this README may be clearer in come parts, while the Jupyter notebook may be clearer in others. It may be helpful to look through the Jupyter notebook and then come back to this README, as what I am describing may not make sense based purely on verbal descriptions.

The directory structure on GitHub is slightly different from the one you will be using if you attempt to replicate my work. I added a few more directories to make the structure on GitHub easier to navigate.

The GitHub structure is:

	•Final_Project (main directory for project files)
	    ⁃	Po (contains all the files for analyzing our polonium crystal unit cells)
	        ⁃	Angles_Test (just a test to confirm that energy calculations for the same edge length on a unit cell but are symmetric about the first quadrant, like 95 degrees and 85 degrees, are the same in energy)
	        ⁃	inputs (input unit cells for Quantum ESPRESSO)
	        ⁃	outputs (energy outputs)
	        ⁃	Strained_Crystal_Structure_Generator.ipynb (Jupyter notebook for this project; everything of interest is here)
		⁃	class_pres_calcs (calculations I did for the structures I showed in my class presentation)
	    ⁃	pseudo (pseudopotentials for our atoms; used in crystal structure energy calculations. If you want to calculate the energy of a new atom here, you should find a pseudo potential from http://pseudopotentials.quantum-espresso.org/legacy_tables and put it in this directory.)
	    ⁃	tmp (contains temporary files that QE generates; not really used)

The structure of your directory if you were to want to repeat my work should be:

	•Final_Project (main directory for project files)
	    ⁃	Po (contains all the files for analyzing our polonium crystal unit cells)
	        ⁃	Strained_Crystal_Structure_Generator.ipynb (Jupyter notebook for this project; everything of interest is here)
	        ⁃	[The Jupyter notebook will generate all of your .in input files and put them in this directory. Your .out output files generated by Quantum ESPRESSO will also go here]
	    ⁃	pseudo (pseudopotentials for our atoms; used in crystal structure energy calculations. If you want to calculate the energy of a new atom here, you should find a pseudo potential from http://pseudopotentials.quantum-espresso.org/legacy_tables and put it in this directory.)
	    ⁃	tmp (contains temporary files that QE generates; not really used)

The important difference here is that my notebook and Quantum ESPRESSO will store input files and output files directly in Po.

The packages I used for this are Seaborn, pandas, numpy, and Quantum ESPRESSO. You can install these all pretty easily. However, Jupyter notebooks and QE seem to be incompatible with each other, so I recommend creating a new environment for QE and then installing it with the command: 

conda install -c conda-forge qe

To work with QE and calculate the energy of a unit cell, you have to use shell commands from the terminal. Make sure the conda environment containing QE is open. To do that, use cd to navigate to the location where your input files are located, and use this command (without the brackets):

pw.x -in [your_input_filename].in > [your_input_filename].out

After this, QE will take the unit cell given in the input file and calculate the energy. Sometimes, this can take up to hours depending on the edge length and angle. If it does get hung up for too long, then it’s probable that you forgot the -in after pw.x (learned from painful experience). Once it is finished, open up the .out file and check the “total energy” near the bottom to get the energy of your crystal structure.

If you're confused or want to know more, you can always refer the PWscf tutorial from the QE website itself: http://www.fisica.uniud.it/~giannozz/QE-Tutorial/

Also, this link includes what each parameter in these input files is but doesn’t really provide a conceptual explanation. I’m including it so that you can modify or add other parameters not explained if necessary: https://www.quantum-espresso.org/Doc/INPUT_PW.html

Essentially, what I did for this project was to calculate the energy of a real life unit cell of an atomic crystal (in this case polonium) and compare it to the energies of multiple strained versions of that unit cell. The idea was to see if the native unit cell dimensions would present an energy basin that the other strained structures would converge to as they became more similar to native unit cell, like they do in evolutionary algorithms.

To do this, I started with the unit cell of polonium, which is a simple cubic. Then, I strained it into a rhombohedral unit cell, which has all edge lengths equal and two sets of three equal angles between vertices (look up a picture if confused; just think of a simple cubic that is bent out of shape). To accomplish this, I wrote a few functions to generate a bunch of strained rhombohedral unit cells at varying edge lengths and angles relative to the original within my notebook. (It will also generate the original unit cell as long as you pass it the correct parameters; the original is just a simple cubic, which is a rhombohedral with an angle of 90 degrees.) 

Note that when I calculated the energies of these strained crystals, when I calculated an angle below 90 degrees, and I mirrored the energies for those above 90 degrees (e.g., if the angle was 85 degrees, I would’ve put the same energy for 95 degrees). This is because of symmetry. An equilateral rhombus/parallelogram with one angle that is going 85 degrees in one direction is just the flipped version of an equilateral rhombus/parallelogram that is going 95 degrees in another direction. I confirmed this by calculating the energy of a unit cell that has an angle of 95 degrees and comparing it with one of the same edge length (6.3117 au) but with an angle of 85 degrees. The energies (in the negative hundreds of Ry) were very similar, only having differences at the sixth decimal place, which shows that symmetry allows these energies to be the same. These results can be observed in the directory “Angles_Test” within “Po.” Just compare the two output files present: po.scf.edge6.3116848019.angle0.0872.out and po.scf.edge6.3116848019.angle-0.0872.out, which calculate the total energy for angles of 85 and 95 degree. Their energies are basically the same at -195.58605517 Ry and -195.58605932 Ry, respectively.

Afterwards, I generated a calculated all of the strained unit cell total energies as described above, using my QE environment. Opening my Jupyter notebook in another environment, I enumerated these total energies, along with the angles and edge lengths of these unit cells, within a pandas data frame by hand, which I used to generate a heat map with Seaborn. After some parameter adjustments, I was able to obtain a clearer Heatmap that showed the energy basin centered around where the native unit cell was, with the energies of the surrounding crystal structures funneling towards it.

This is how evolutionary (and other crystal structure prediction) algorithms work in general. As you find lower and lower energy structures, your structures should match the actual crystal structure more and more; you funnel down this free energy surface towards the native unit cell like a protein folding to its native structure in a protein folding funnel.
